# LLM-AndroidPentest Architecture

## System Overview

```
┌──────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                      │
│                            LLM-ANDROID PENTEST FRAMEWORK                             │
│                     Automated Android Exploitation via LLM Agent                     │
│                                                                                      │
├──────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌────────────────┐     ┌─────────────────────────────────────────────────────────┐ │
│  │                │     │                     AGENT LAYER                          │ │
│  │    USER        │     │                  (The "Engine")                          │ │
│  │                │     │                                                          │ │
│  │  ┌──────────┐  │     │  ┌─────────────────────────────────────────────────┐    │ │
│  │  │ Web UI   │──┼────►│  │              ORCHESTRATION CHAIN                │    │ │
│  │  │ Chat     │  │     │  │                                                 │    │ │
│  │  │ Scripts  │  │     │  │    ┌─────────┐    ┌───────────┐    ┌─────────┐ │    │ │
│  │  │ Chain    │  │     │  │    │         │    │           │    │         │ │    │ │
│  │  └──────────┘  │     │  │    │ PLANNER │───►│ GENERATOR │───►│SUMMARIZER│ │    │ │
│  │                │     │  │    │         │    │           │    │         │ │    │ │
│  │  ┌──────────┐  │     │  │    └────┬────┘    └─────┬─────┘    └────┬────┘ │    │ │
│  │  │   CLI    │──┼────►│  │         │               │               │      │    │ │
│  │  │  Tools   │  │     │  │         ▼               ▼               ▼      │    │ │
│  │  └──────────┘  │     │  │    ┌─────────────────────────────────────────┐ │    │ │
│  │                │     │  │    │           PROMPT TEMPLATES              │ │    │ │
│  └────────────────┘     │  │    │  reconnaissance.md │ exploitation.md   │ │    │ │
│                         │  │    │  vulnerability.md  │ verification.md   │ │    │ │
│                         │  │    └─────────────────────────────────────────┘ │    │ │
│                         │  └─────────────────────────────────────────────────┘    │ │
│                         │                          │                               │ │
│                         │                          ▼                               │ │
│                         │  ┌─────────────────────────────────────────────────┐    │ │
│                         │  │                 LLM PROVIDERS                    │    │ │
│                         │  │                                                  │    │ │
│                         │  │   ┌─────────┐   ┌─────────┐   ┌───────────┐     │    │ │
│                         │  │   │ OLLAMA  │   │ OPENAI  │   │ ANTHROPIC │     │    │ │
│                         │  │   │ (Local) │   │  (API)  │   │   (API)   │     │    │ │
│                         │  │   └─────────┘   └─────────┘   └───────────┘     │    │ │
│                         │  └─────────────────────────────────────────────────┘    │ │
│                         └─────────────────────────────────────────────────────────┘ │
│                                                    │                                 │
│                                                    ▼                                 │
│  ┌───────────────────────────────────────────────────────────────────────────────┐  │
│  │                              CORE MODULES                                      │  │
│  │                                                                                │  │
│  │  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────────────────┐ │  │
│  │  │  RECONNAISSANCE  │  │     SCANNING     │  │        EXPLOITATION          │ │  │
│  │  │                  │  │                  │  │                              │ │  │
│  │  │ • ADB Connection │  │ • Vuln Scanner   │  │ • Exploit Runner             │ │  │
│  │  │ • Device Enum    │  │ • CVE Matcher    │  │ • Magisk Root                │ │  │
│  │  │ • Service Disc.  │  │ • Perm Analyzer  │  │ • Kernel Exploits            │ │  │
│  │  │                  │  │                  │  │ • ADB Exploits               │ │  │
│  │  │                  │  │                  │  │ • Bootloader Unlock          │ │  │
│  │  └────────┬─────────┘  └────────┬─────────┘  └──────────────┬───────────────┘ │  │
│  │           │                     │                           │                  │  │
│  │           └─────────────────────┼───────────────────────────┘                  │  │
│  │                                 ▼                                              │  │
│  │                    ┌──────────────────────┐                                    │  │
│  │                    │     VERIFICATION     │                                    │  │
│  │                    │                      │                                    │  │
│  │                    │   • Root Check       │                                    │  │
│  │                    │   • Capability Test  │                                    │  │
│  │                    │   • Report Gen       │                                    │  │
│  │                    └──────────────────────┘                                    │  │
│  └───────────────────────────────────────────────────────────────────────────────┘  │
│                                                    │                                 │
│                                                    ▼                                 │
│  ┌───────────────────────────────────────────────────────────────────────────────┐  │
│  │                              TARGET DEVICE                                     │  │
│  │                                                                                │  │
│  │     ┌─────────────────────────────────────────────────────────────────────┐   │  │
│  │     │                      GENYMOTION EMULATOR                            │   │  │
│  │     │                                                                     │   │  │
│  │     │    ┌──────────────┐          ADB (TCP/5555)          ┌──────────┐  │   │  │
│  │     │    │   Android    │◄────────────────────────────────►│  Host    │  │   │  │
│  │     │    │   11 / API30 │                                  │  Machine │  │   │  │
│  │     │    │   Pixel 7    │       Commands / Responses       │          │  │   │  │
│  │     │    └──────────────┘                                  └──────────┘  │   │  │
│  │     │                                                                     │   │  │
│  │     └─────────────────────────────────────────────────────────────────────┘   │  │
│  └───────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                      │
└──────────────────────────────────────────────────────────────────────────────────────┘
```

## Attack Chain Flow

```
                                    START
                                      │
                                      ▼
                        ┌─────────────────────────────┐
                        │      1. RECONNAISSANCE      │
                        │                             │
                        │  • Connect via ADB          │
                        │  • Enumerate device props   │
                        │  • Discover services        │
                        │  • Fingerprint security     │
                        └──────────────┬──────────────┘
                                       │
                                       ▼
                        ┌─────────────────────────────┐
                        │       2. SCANNING           │
                        │                             │
                        │  • Match CVEs to device     │
                        │  • Analyze permissions      │
                        │  • Check misconfigs         │
                        │  • Score risk levels        │
                        └──────────────┬──────────────┘
                                       │
                                       ▼
                        ┌─────────────────────────────┐
                        │     3. EXPLOITATION         │
                        │                             │
                        │  ┌───────────────────────┐  │
                        │  │   LLM Script Gen      │  │
                        │  │                       │  │
                        │  │  "Root this device"   │  │
                        │  │         │             │  │
                        │  │         ▼             │  │
                        │  │  ┌─────────────┐      │  │
                        │  │  │ Python/Bash │      │  │
                        │  │  │   Script    │      │  │
                        │  │  └─────────────┘      │  │
                        │  └───────────────────────┘  │
                        │                             │
                        │  • Execute exploit          │
                        │  • Capture output           │
                        └──────────────┬──────────────┘
                                       │
                              ┌────────┴────────┐
                              │                 │
                              ▼                 ▼
                        ┌───────────┐     ┌───────────┐
                        │  SUCCESS  │     │  FAILURE  │
                        └─────┬─────┘     └─────┬─────┘
                              │                 │
                              │                 ▼
                              │    ┌─────────────────────┐
                              │    │  SUMMARIZER         │
                              │    │                     │
                              │    │  • Analyze output   │
                              │    │  • Extract learnings│
                              │    │  • Suggest next     │
                              │    └──────────┬──────────┘
                              │               │
                              │               ▼
                              │    ┌─────────────────────┐
                              │    │  PLANNER            │
                              │    │                     │
                              │    │  • Adjust strategy  │
                              │    │  • Try alternate    │
                              │    └──────────┬──────────┘
                              │               │
                              │               └──────┐
                              │                      │
                              ▼                      │
                        ┌─────────────────────────┐  │
                        │     4. VERIFICATION     │  │
                        │                         │◄─┘
                        │  • Check root access    │   (retry loop)
                        │  • Test capabilities    │
                        │  • Generate report      │
                        └──────────────┬──────────┘
                                       │
                                       ▼
                                     DONE
```

## Component Interaction Diagram

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                           DATA FLOW & INTERACTIONS                               │
└──────────────────────────────────────────────────────────────────────────────────┘

     User                   Agent Layer                   Core Modules         Target
      │                         │                              │                   │
      │   "Root this device"    │                              │                   │
      │────────────────────────►│                              │                   │
      │                         │                              │                   │
      │                    ┌────┴────┐                         │                   │
      │                    │ PLANNER │                         │                   │
      │                    └────┬────┘                         │                   │
      │                         │                              │                   │
      │                         │ Phase: RECON                 │                   │
      │                         │─────────────────────────────►│                   │
      │                         │                              │   adb shell      │
      │                         │                              │──────────────────►│
      │                         │                              │   device props   │
      │                         │                              │◄──────────────────│
      │                         │          DeviceInfo          │                   │
      │                         │◄─────────────────────────────│                   │
      │                         │                              │                   │
      │                    ┌────┴────┐                         │                   │
      │                    │GENERATOR│                         │                   │
      │                    └────┬────┘                         │                   │
      │                         │                              │                   │
      │                         │──────┐                       │                   │
      │                         │      │ Query LLM             │                   │
      │                         │      │ "Generate exploit     │                   │
      │                         │      │  for Android 11"      │                   │
      │                         │◄─────┘                       │                   │
      │                         │      Python Script           │                   │
      │                         │                              │                   │
      │                         │         Execute              │                   │
      │                         │─────────────────────────────►│                   │
      │                         │                              │   adb push/exec  │
      │                         │                              │──────────────────►│
      │                         │                              │   result         │
      │                         │                              │◄──────────────────│
      │                         │        ExecResult            │                   │
      │                         │◄─────────────────────────────│                   │
      │                         │                              │                   │
      │                    ┌────┴─────┐                        │                   │
      │                    │SUMMARIZER│                        │                   │
      │                    └────┬─────┘                        │                   │
      │                         │                              │                   │
      │                         │──────┐                       │                   │
      │                         │      │ Analyze result        │                   │
      │                         │      │ Extract findings      │                   │
      │                         │◄─────┘                       │                   │
      │                         │                              │                   │
      │   Report + Findings     │                              │                   │
      │◄────────────────────────│                              │                   │
      │                         │                              │                   │
```

## Module Dependencies

```
                    ┌─────────────────────────────────────────┐
                    │              webapp/app.py              │
                    │            (User Interface)             │
                    └───────────────────┬─────────────────────┘
                                        │
                    ┌───────────────────┼───────────────────┐
                    │                   │                   │
                    ▼                   ▼                   ▼
        ┌───────────────────┐ ┌─────────────────┐ ┌─────────────────┐
        │      agent/       │ │     core/       │ │     config/     │
        │                   │ │                 │ │                 │
        │ ┌───────────────┐ │ │ ┌─────────────┐ │ │ • settings.yaml │
        │ │  llm_client   │ │ │ │   recon/    │ │ │ • .env          │
        │ └───────┬───────┘ │ │ └──────┬──────┘ │ │ • emulator/     │
        │         │         │ │        │        │ └─────────────────┘
        │ ┌───────▼───────┐ │ │ ┌──────▼──────┐ │
        │ │    planner    │ │ │ │  scanning/  │ │
        │ └───────┬───────┘ │ │ └──────┬──────┘ │
        │         │         │ │        │        │
        │ ┌───────▼───────┐ │ │ ┌──────▼──────┐ │
        │ │   generator   │─┼─┼─│exploitation/│ │
        │ └───────┬───────┘ │ │ └──────┬──────┘ │
        │         │         │ │        │        │
        │ ┌───────▼───────┐ │ │ ┌──────▼──────┐ │
        │ │  summarizer   │ │ │ │verification/│ │
        │ └───────┬───────┘ │ │ └─────────────┘ │
        │         │         │ │                 │
        │ ┌───────▼───────┐ │ └─────────────────┘
        │ │    chains/    │ │
        │ │ android_root  │ │
        │ └───────────────┘ │
        │                   │
        │ ┌───────────────┐ │
        │ │   prompts/    │ │
        │ │  (templates)  │ │
        │ └───────────────┘ │
        └───────────────────┘
```

## Framework vs Engine

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                                                                                  │
│   ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   │
│   ░░░░░░░░░░░░░░░░░░░░░░  FRAMEWORK (Reusable)  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   │
│   ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   │
│   ░░                                                                        ░░   │
│   ░░   Docker │ Compose │ Streamlit UI │ Config Mgmt │ LLM Abstraction     ░░   │
│   ░░   ADB Wrapper │ Script Sandbox │ Memory Store │ Report Generation     ░░   │
│   ░░                                                                        ░░   │
│   ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░   │
│                                                                                  │
│   ████████████████████████████████████████████████████████████████████████████   │
│   ██████████████████████  ENGINE (Novel IP)  █████████████████████████████████   │
│   ████████████████████████████████████████████████████████████████████████████   │
│   ██                                                                        ██   │
│   ██   Prompt Engineering │ Planner/Summarizer Chain │ NL→Script Gen       ██   │
│   ██   CVE Matching │ Kernel Exploit Detection │ Attack Chain Logic        ██   │
│   ██   Device Fingerprinting │ Permission Risk Scoring │ Root Verification ██   │
│   ██                                                                        ██   │
│   ████████████████████████████████████████████████████████████████████████████   │
│                                                                                  │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓   │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓  EXTENSIBILITY POINTS  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓   │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓   │
│   ▓▓                                                                        ▓▓   │
│   ▓▓   + New CVEs          → cve_matcher.py                                 ▓▓   │
│   ▓▓   + New Exploits      → techniques/*.py                                ▓▓   │
│   ▓▓   + New Devices       → emulator/*.yaml                                ▓▓   │
│   ▓▓   + New LLM Providers → llm_client.py                                  ▓▓   │
│   ▓▓   + New Prompts       → prompts/*.md                                   ▓▓   │
│   ▓▓                                                                        ▓▓   │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓   │
│                                                                                  │
└──────────────────────────────────────────────────────────────────────────────────┘
```

## Technology Stack

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              TECHNOLOGY STACK                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  FRONTEND                    BACKEND                    INFRASTRUCTURE          │
│  ─────────                   ───────                    ──────────────          │
│                                                                                 │
│  ┌─────────────┐            ┌─────────────┐            ┌─────────────┐         │
│  │  Streamlit  │            │   Python    │            │   Docker    │         │
│  │    8501     │            │    3.11+    │            │  Compose    │         │
│  └─────────────┘            └─────────────┘            └─────────────┘         │
│                                                                                 │
│  AI/LLM                      ANDROID                    STORAGE                 │
│  ──────                      ───────                    ───────                 │
│                                                                                 │
│  ┌─────────────┐            ┌─────────────┐            ┌─────────────┐         │
│  │   Ollama    │            │ Genymotion  │            │  ChromaDB   │         │
│  │   (Local)   │            │  (QEMU)     │            │  (Vectors)  │         │
│  ├─────────────┤            ├─────────────┤            └─────────────┘         │
│  │   OpenAI    │            │     ADB     │                                    │
│  │   (API)     │            │   (Bridge)  │                                    │
│  ├─────────────┤            └─────────────┘                                    │
│  │  Anthropic  │                                                               │
│  │   (API)     │                                                               │
│  └─────────────┘                                                               │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```
