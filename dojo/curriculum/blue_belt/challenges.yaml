challenges:
- id: blue_001
  name: Kernel Exploit Synthesis
  description: "Generate a C-based exploit skeleton for a known null-pointer dereference\
    \ \nvulnerability. The exploit should attempt to overwrite the current process\
    \ \ncredentials with root (UID 0).\n"
  belt: blue
  difficulty: 4
  script_type: c_exploit
  inputs:
    device_id: emulator-5554
    target_kernel: Linux version 3.10.0
    device_context:
      task: privilege escalation
      vulnerability: Null pointer dereference
  validation:
    type: regex_match
    pattern: '#include <stdio.h>'
  hints:
  - Look for 'commit_creds' and 'prepare_kernel_cred' patterns
  - Use ioctl() calls to trigger the vulnerability
  - Target process credentials structure
  kata_solution: "#include <stdio.h>\n#include <sys/ioctl.h>\nint main() {\n    printf(\"\
    Exploiting kernel...\\n\");\n    // Logic to trigger null pointer dereference\
    \ would go here\n    return 0;\n}\n"
  tags:
  - kernel
  - exploitation
  - c-code
- id: blue_002
  name: Exploit Staging & Execution
  description: 'Write a multi-part ADB script that:

    1. Pushes an exploit binary to /data/local/tmp

    2. Fixes permissions

    3. Executes the binary and checks if the resulting shell is root.

    '
  belt: blue
  difficulty: 3
  script_type: adb
  inputs:
    device_id: emulator-5554
    device_context:
      task: deploy and verify exploit
  validation:
    type: output_contains
    expected: uid=0
  hints:
  - Use 'adb push' followed by 'chmod'
  - Pipe the output of 'id' to check for root
  kata_solution: shell push exploit /data/local/tmp/ && shell chmod 755 /data/local/tmp/exploit
    && shell /data/local/tmp/exploit && shell id
  tags:
  - staging
  - chain
  - root
- id: blue_003
  name: Kernel Credentials Overwrite
  description: "Write the C code required to escalate a process to root privileges\
    \ \nby overwriting its task_struct credentials. Use the kernel internal \nfunctions\
    \ commit_creds and prepare_kernel_cred.\n"
  belt: blue
  difficulty: 5
  script_type: c_exploit
  inputs:
    device_id: emulator-5554
    device_context:
      task: direct credential overwrite
  validation:
    type: regex_match
    pattern: commit_creds\(prepare_kernel_cred\(0\)\)
  hints:
  - The pattern commit_creds(prepare_kernel_cred(0)) is the classic way to get root
  - Ensure you have the correct function signatures
  kata_solution: "#include <linux/cred.h>\nvoid get_root() {\n    commit_creds(prepare_kernel_cred(0));\n\
    }\n"
  tags:
  - kernel-internals
  - root
- id: blue_004
  name: Driver IOCTL Interaction
  description: "Write a C program that opens the /dev/binder device and sends a \n\
    malformed ioctl command. This is used to test for race conditions \nor memory\
    \ corruption in the binder driver.\n"
  belt: blue
  difficulty: 4
  script_type: c_exploit
  inputs:
    device_id: emulator-5554
    device_context:
      task: trigger binder vulnerability
  validation:
    type: regex_match
    pattern: ioctl\(fd,
  hints:
  - Use open("/dev/binder", O_RDONLY)
  - The ioctl function is the primary interface for driver interaction
  kata_solution: "#include <fcntl.h>\n#include <sys/ioctl.h>\nint main() {\n    int\
    \ fd = open(\"/dev/binder\", O_RDONLY);\n    ioctl(fd, 0xDEADBEEF, NULL);\n  \
    \  return 0;\n}\n"
  tags:
  - driver
  - binder
  - ioctl
- id: blue_cve_2021_23162
  name: 'CVE Analysis: CVE-2021-23162'
  description: 'Target: CVE-2021-23162


    Improper validation of the cloud certificate chain in Mobile Connect allows man-in-the-middle
    attack to impersonate the legitimate Command Centre Server. This issue affects:
    Gallagher Command Centre Mobile Connect for Android 15 versions prior to 15.04.040;
    version 14 and prior versions.


    Goal: Probe the device to determine if it is vulnerable to this specific issue.'
  belt: blue
  difficulty: 3
  script_type: adb
  inputs:
    cve_id: CVE-2021-23162
    device_context:
      connection: adb
      task: vulnerability_probing
      severity: HIGH
  expected_output:
    must_contain:
    - CVE-2021-23162
    expected_patterns: []
  scoring:
    syntax_correct: 25
    api_valid: 25
    executes_successfully: 30
    achieves_objective: 20
  tags:
  - nvd-generated
  - cve-2021-23162
  - cwe-296
  - cwe-295
