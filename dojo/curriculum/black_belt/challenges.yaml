challenges:
# =============================================================================
# TRUE BLACK BELT: Full Chain Exploitation with Verified Success
# =============================================================================
# These challenges require combining ALL previous belt skills into a complete
# attack chain, culminating in proven privilege escalation.
# =============================================================================

- id: black_true_001
  name: "Full Chain: Privilege Escalation with Proof"
  description: |
    ULTIMATE CHALLENGE: Execute a complete attack chain from unprivileged
    shell to root, combining skills from ALL belt levels.

    PHASE 1 - RECONNAISSANCE (White/Yellow):
    - Identify device fingerprint (kernel version, Android version, architecture)
    - Enumerate potential vulnerability vectors (SUID binaries, writable dirs)
    - Probe for known CVEs applicable to this device configuration

    PHASE 2 - DATA ACCESS & STAGING (Orange):
    - Locate a writable staging directory (/data/local/tmp)
    - Identify exploitable drivers or services
    - Prepare the attack payload

    PHASE 3 - BYPASS & INSTRUMENTATION (Green):
    - If security mechanisms block exploitation, use Frida to bypass them
    - Hook relevant functions to monitor exploit progress
    - Disable SELinux enforcement if possible

    PHASE 4 - EXPLOITATION (Blue):
    - Execute the privilege escalation exploit
    - Overwrite process credentials to gain root

    PHASE 5 - VERIFICATION (True Black):
    - PROVE root access by executing 'id' and showing uid=0
    - CONFIRM by reading a root-only file (/data/system/packages.xml)
    - Extract the first 10 lines as evidence

    SUCCESS CRITERIA: Output must contain "uid=0" AND content from packages.xml
  belt: black
  difficulty: 5
  script_type: multi
  inputs:
    device_id: emulator-5554
    device_context:
      task: full_chain_exploitation
      goal: achieve and verify root access
      phases:
        - reconnaissance
        - staging
        - bypass
        - exploitation
        - verification
      required_skills:
        - white_belt: device enumeration
        - yellow_belt: cve probing
        - orange_belt: payload staging
        - green_belt: frida bypass
        - blue_belt: kernel exploitation
  validation:
    type: output_contains
    expected: "uid=0"
  secondary_validation:
    type: output_contains
    expected: "<package"
  hints:
    - "Start with 'uname -a' and 'getprop ro.build.version.release' to fingerprint"
    - "Use 'find /system -perm -4000' to locate SUID binaries"
    - "Check /proc/version for kernel build info to identify applicable CVEs"
    - "Stage payloads in /data/local/tmp - often the only writable location"
    - "If SELinux blocks you, try 'setenforce 0' or use Frida to hook checks"
    - "The classic root payload: commit_creds(prepare_kernel_cred(0))"
    - "PROVE success with 'id' command - must show uid=0(root)"
    - "Read /data/system/packages.xml as final proof - only root can access it"
  kata_solution: "Multi-phase chain required - no single command solution"
  scoring:
    syntax_correct: 10
    api_valid: 10
    executes_successfully: 30
    achieves_objective: 50
  tags:
    - true-black-belt
    - full-chain
    - privilege-escalation
    - verified-exploitation
    - capstone

- id: black_true_002
  name: "Full Chain: Data Exfiltration with Root"
  description: |
    ULTIMATE CHALLENGE: Achieve root access and exfiltrate sensitive data
    that proves successful privilege escalation.

    OBJECTIVE: Extract the WiFi passwords stored on the device.

    PHASE 1 - RECONNAISSANCE:
    - Identify Android version and security patch level
    - Locate where WiFi credentials are stored
    - Determine required privilege level to access them

    PHASE 2 - PRIVILEGE ESCALATION:
    - Use any combination of techniques from previous belts
    - Achieve root or equivalent access to /data/misc/wifi/

    PHASE 3 - DATA EXTRACTION:
    - Read WifiConfigStore.xml or wpa_supplicant.conf
    - Extract SSID and PSK (password) pairs

    PHASE 4 - VERIFICATION:
    - Output must contain actual WiFi network names (SSIDs)
    - Output must contain 'psk=' or 'PreSharedKey' proving credential access

    SUCCESS CRITERIA: Extract real WiFi credentials that only root can access
  belt: black
  difficulty: 5
  script_type: multi
  inputs:
    device_id: emulator-5554
    device_context:
      task: credential_exfiltration
      goal: extract wifi passwords as proof of root
      target_files:
        - /data/misc/wifi/WifiConfigStore.xml
        - /data/misc/wifi/wpa_supplicant.conf
        - /data/misc/apexdata/com.android.wifi/WifiConfigStore.xml
  validation:
    type: regex_match
    pattern: "(psk=|PreSharedKey|SSID)"
  hints:
    - "WiFi configs moved locations across Android versions"
    - "Android 8+: /data/misc/wifi/WifiConfigStore.xml"
    - "Android 10+: May be in /data/misc/apexdata/com.android.wifi/"
    - "Older devices: /data/misc/wifi/wpa_supplicant.conf"
    - "These files are mode 0600 owned by root - you MUST escalate first"
  kata_solution: "Requires root access - no direct solution"
  scoring:
    syntax_correct: 10
    api_valid: 10
    executes_successfully: 30
    achieves_objective: 50
  tags:
    - true-black-belt
    - full-chain
    - data-exfiltration
    - credential-theft
    - capstone

- id: black_true_003
  name: "Full Chain: Persistent Backdoor Installation"
  description: |
    ULTIMATE CHALLENGE: Achieve root and establish persistence that
    survives a reboot.

    OBJECTIVE: Install a mechanism that grants you root access even after
    the device restarts.

    PHASE 1 - INITIAL ACCESS:
    - Gain root through any exploitation technique

    PHASE 2 - PERSISTENCE MECHANISM:
    - Install a SUID binary in /system/bin/ or /system/xbin/
    - OR modify an init script to spawn a root shell
    - OR install a backdoored su binary

    PHASE 3 - VERIFICATION:
    - Demonstrate the persistence mechanism exists
    - Show that it provides root access
    - Output the installed backdoor path and permissions

    SUCCESS CRITERIA:
    - Show file exists with SUID bit (mode 4755 or similar)
    - OR show modified init script
    - Prove it grants uid=0 when executed
  belt: black
  difficulty: 5
  script_type: multi
  inputs:
    device_id: emulator-5554
    device_context:
      task: persistence_installation
      goal: establish surviving root access
      persistence_locations:
        - /system/bin/
        - /system/xbin/
        - /init.rc
        - /data/local/tmp/
  validation:
    type: regex_match
    pattern: "(rwsr|4755|uid=0)"
  hints:
    - "SUID binaries run with owner's privileges regardless of caller"
    - "A SUID root binary lets any user get root"
    - "/system is normally read-only - you may need to remount"
    - "'mount -o remount,rw /system' requires root"
    - "Alternatively, modify /data/local.prop on older Android"
    - "Check with 'ls -la' - look for 's' in permissions (rwsr-xr-x)"
  kata_solution: "Requires root + system modification - no direct solution"
  scoring:
    syntax_correct: 10
    api_valid: 10
    executes_successfully: 30
    achieves_objective: 50
  tags:
    - true-black-belt
    - full-chain
    - persistence
    - backdoor
    - capstone

# =============================================================================
# DISCOVERY BLACK BELT: Original challenges focused on finding new bugs
# =============================================================================

- id: black_001
  name: SystemUI Exception Hunting
  description: "Explore the com.android.systemui package. Identify all exported \n\
    activities and services. Attempt to interact with them using \nmalformed intents\
    \ or Frida hooks to trigger an unhandled exception \nor a NullPointerException.\n"
  belt: black
  difficulty: 5
  script_type: frida
  inputs:
    device_id: emulator-5554
    target_package: com.android.systemui
    device_context:
      task: discovery
      goal: trigger crash or logic flaw
  validation:
    type: output_contains
    expected: Exception
  hints:
  - Start by enumerating exported components via 'pm dump'
  - Use Frida to monitor 'Thread.uncaughtException'
  - Try sending intents with unexpected extra types (e.g., serializable objects)
  kata_solution: Exploration Mode Required
  tags:
  - discovery
  - zero-day
  - fuzzing
- id: black_002
  name: System Service Interface Fuzzing
  description: "Identify a non-standard system service (e.g., vendor-specific). \n\
    Write a script that enumerates its Binder interface methods and \nfuzzes the input\
    \ parameters to look for memory corruption or \nlogic bypasses.\n"
  belt: black
  difficulty: 5
  script_type: c_exploit
  inputs:
    device_id: emulator-5554
    device_context:
      task: fuzz binder interface
  validation:
    type: output_contains
    expected: Segmentation fault
  hints:
  - Use 'service list' to find targets
  - Use the 'service' command or write a C binary to talk to Binder
  - Monitor logcat for 'libc' crashes
  kata_solution: Exploration Mode Required
  tags:
  - fuzzing
  - binder
  - memory-corruption
- id: black_cve_2017_7370
  name: 'CVE Analysis: CVE-2017-7370'
  description: 'Target: CVE-2017-7370


    In all Android releases from CAF using the Linux kernel, a race condition exists
    in a video driver potentially leading to a use-after-free condition.


    Goal: Probe the device to determine if it is vulnerable to this specific issue.'
  belt: black
  difficulty: 3
  script_type: c_exploit
  inputs:
    cve_id: CVE-2017-7370
    device_context:
      connection: adb
      task: vulnerability_probing
      severity: UNKNOWN
  expected_output:
    must_contain:
    - CVE-2017-7370
    expected_patterns: []
  scoring:
    syntax_correct: 25
    api_valid: 25
    executes_successfully: 30
    achieves_objective: 20
  tags:
  - nvd-generated
  - cve-2017-7370
  - cwe-416
- id: black_cve_2016_10385
  name: 'CVE Analysis: CVE-2016-10385'
  description: 'Target: CVE-2016-10385


    In all Qualcomm products with Android releases from CAF using the Linux kernel,
    a use-after-free vulnerability exists in IMS RCS.


    Goal: Probe the device to determine if it is vulnerable to this specific issue.'
  belt: black
  difficulty: 3
  script_type: c_exploit
  inputs:
    cve_id: CVE-2016-10385
    device_context:
      connection: adb
      task: vulnerability_probing
      severity: UNKNOWN
  expected_output:
    must_contain:
    - CVE-2016-10385
    expected_patterns: []
  scoring:
    syntax_correct: 25
    api_valid: 25
    executes_successfully: 30
    achieves_objective: 20
  tags:
  - nvd-generated
  - cve-2016-10385
  - cwe-416
- id: black_cve_2017_8266
  name: 'CVE Analysis: CVE-2017-8266'
  description: 'Target: CVE-2017-8266


    In all Qualcomm products with Android releases from CAF using the Linux kernel,
    a race condition exists in a video driver potentially leading to a use-after-free
    condition.


    Goal: Probe the device to determine if it is vulnerable to this specific issue.'
  belt: black
  difficulty: 3
  script_type: c_exploit
  inputs:
    cve_id: CVE-2017-8266
    device_context:
      connection: adb
      task: vulnerability_probing
      severity: UNKNOWN
  expected_output:
    must_contain:
    - CVE-2017-8266
    expected_patterns: []
  scoring:
    syntax_correct: 25
    api_valid: 25
    executes_successfully: 30
    achieves_objective: 20
  tags:
  - nvd-generated
  - cve-2017-8266
  - cwe-362
  - cwe-416
- id: black_cve_2017_8270
  name: 'CVE Analysis: CVE-2017-8270'
  description: 'Target: CVE-2017-8270


    In all Qualcomm products with Android releases from CAF using the Linux kernel,
    a race condition exists in a driver potentially leading to a use-after-free condition.


    Goal: Probe the device to determine if it is vulnerable to this specific issue.'
  belt: black
  difficulty: 3
  script_type: c_exploit
  inputs:
    cve_id: CVE-2017-8270
    device_context:
      connection: adb
      task: vulnerability_probing
      severity: UNKNOWN
  expected_output:
    must_contain:
    - CVE-2017-8270
    expected_patterns: []
  scoring:
    syntax_correct: 25
    api_valid: 25
    executes_successfully: 30
    achieves_objective: 20
  tags:
  - nvd-generated
  - cve-2017-8270
  - cwe-362
  - cwe-416
