# Rooted Android 14 Persona
# =============================================================================
# A rooted Android 14 device for advanced exploitation training.
# Inherits from android_14_user.yaml and enables root capabilities.
# =============================================================================

inherits: android_14_user
name: "Rooted Android 14 - Security Researcher"
description: |
  A rooted Android 14 emulator configured for security research.
  Root access enables advanced exploitation techniques including:
  - Reading any app's private data
  - Modifying system files
  - Bypassing permission checks
  - Process injection and hooking

# =============================================================================
# ROOT CONFIGURATION (Override base)
# =============================================================================
root:
  enabled: true
  method: magisk  # Simulated Magisk root

  # Hide root from apps that check for it
  hide_root: true

  # Full capabilities for research
  capabilities:
    read_app_data: true      # Can read /data/data/* for any app
    write_system: true       # Can modify /system
    read_wifi_config: true   # Can read WiFi passwords
    modify_selinux: true     # Can set SELinux permissive
    process_injection: true  # Can use Frida/ptrace
    kernel_access: false     # Still limited without custom kernel

# =============================================================================
# ADDITIONAL TOOLS FOR ROOTED DEVICE
# =============================================================================
apps:
  root_tools:
    - package: eu.chainfire.supersu
      name: "SuperSU"
      required: false
      notes: "Legacy root management"

    - package: com.topjohnwu.magisk
      name: "Magisk Manager"
      required: true
      notes: "Modern root management with hiding"

    - package: me.weishu.kernelsu
      name: "KernelSU"
      required: false
      notes: "Alternative kernel-based root"

  # Frida for runtime manipulation
  frida:
    server_version: "16.1.4"
    auto_start: true
    port: 27042

# =============================================================================
# ROOTED DEVICE SPECIFIC TRAINING DATA
# =============================================================================
user_data:
  # Files that demonstrate root access was used
  files:
    documents:
      required:
        - path: /data/local/tmp/root_test.txt
          content: "Root access verified - FLAG{device_rooted}"

        - path: /system/etc/security_notes.txt
          content: |
            Security Research Device
            Root enabled via Magisk
            SELinux: Permissive mode available

            FLAG{system_write_access}

# =============================================================================
# EXPLOITATION TRAINING CONTEXT
# =============================================================================
training_context:
  device_mode: rooted

  # What the model should understand about this environment
  capabilities_description: |
    This is a ROOTED Android 14 device. You have:
    - Full filesystem access (including /data/data/*)
    - Ability to run commands as root (su -c <command>)
    - Frida server running for runtime manipulation
    - SELinux can be set to permissive mode
    - Can read WiFi credentials from /data/misc/wifi/
    - Can modify system partitions

  # Common root commands to demonstrate
  example_commands:
    - command: "su -c id"
      description: "Verify root access"
      expected_output: "uid=0(root)"

    - command: "su -c cat /data/data/com.target.app/databases/secret.db"
      description: "Read protected app database"

    - command: "su -c setenforce 0"
      description: "Set SELinux to permissive"

    - command: "su -c cat /data/misc/wifi/WifiConfigStore.xml"
      description: "Extract saved WiFi passwords"
